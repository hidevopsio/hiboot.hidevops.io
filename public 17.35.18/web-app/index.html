<!DOCTYPE html>
  
  
  
  
   
  <html class="no-js" lang="en"> 
  

  <head lang="en">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Web Application - Hiboot Cloud Native Application Framework</title>
    <meta name="generator" content="Hugo 0.59.1" />

    
    <meta name="description" content="Official site hidevops.io">
    
    <link rel="canonical" href="https://hiboot.hidevops.io/web-app/">
    
    <meta name="author" content="John Deng">
    

    <meta property="og:url" content="https://hiboot.hidevops.io/web-app/">
    <meta property="og:title" content="Hiboot Cloud Native Application Framework">
    <meta property="og:image" content="https://hiboot.hidevops.io/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Hiboot Cloud Native Application Framework">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://hiboot.hidevops.io/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://hiboot.hidevops.io/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://hiboot.hidevops.io/fonts/icon.eot');
        src: url('https://hiboot.hidevops.io/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://hiboot.hidevops.io/fonts/icon.woff')
               format('woff'),
             url('https://hiboot.hidevops.io/fonts/icon.ttf')
               format('truetype'),
             url('https://hiboot.hidevops.io/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://hiboot.hidevops.io/stylesheets/application.css">
    <link rel="stylesheet" href="https://hiboot.hidevops.io/stylesheets/_animation.css">
    <link rel="stylesheet" href="https://hiboot.hidevops.io/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://hiboot.hidevops.io/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://hiboot.hidevops.io/icons/style.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://hiboot.hidevops.io/javascripts/modernizr.js"></script>
    <script src="https://hiboot.hidevops.io/javascripts/growingio.js"></script>

    

  </head>
  <body class="palette-primary-cyan palette-accent-deep-purple">
    

<div class="backdrop">
    <div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
    <nav aria-label="Header">
    <div class="bar default zindex11">
        <div class="button button-menu" role="button" aria-label="Menu">
            <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
        </div>
        <div class="stretch">
            <div class="title">
                Web Application
            </div>
        </div>

        <div class="button button-home" role="button" aria-label="Home">
            <a href="https://hidevops.io" title="Home" target="_blank"  class="toggle-button icon icons-home"></a>
        </div>
        <div class="button button-twitter language_btn" role="button" aria-label="Twitter">
            <a href="javascript:;" title="Switch languages" class="toggle-button icons-globe"></a>
            <div class="layer_box">
                
                  
                  <a href="https://hiboot.hidevops.io/cn" lang="cn">中文</a>
                  
                
                  
                
            </div>
        </div>
        
        <div class="button button-twitter" role="button" aria-label="Twitter">
            <a href="https://twitter.com/johndcn" title="@johndcn on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
        </div>
         
        <div class="button button-github" role="button" aria-label="GitHub">
            <a href="https://github.com/hidevopsio" title="@hidevopsio on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
        </div>
        

        <div class="button button-search" role="button" aria-label="Search">
            <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
        </div>
    </div>
    <div class="bar search">
        <div class="button button-close" role="button" aria-label="Close">
            <label class="toggle-button icon icon-back" for="toggle-search"></label>
        </div>
        <div class="stretch">
            <div class="field">
                <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
            </div>
        </div>
        <div class="button button-reset" role="button" aria-label="Search">
            <button class="toggle-button icon icon-close" id="reset-search"></button>
        </div>
    </div>
</nav>
</header>

<main class="main">
    <div class="drawer">
        <nav aria-label="Navigation">
    <a href="https://hiboot.hidevops.io/en" class="project">
        <div class="banner">
            
            <div class="logo">
                <img src="https://hiboot.hidevops.io/images/logo.png">
            </div>
            
            <div class="name">
                <strong>Hiboot Cloud Native Application Framework <span class="version">v1.2.1</span></strong> 
                <br> 
            </div>
        </div>
    </a>

    <div class="scrollable">
        <div class="wrapper">
            
            <ul class="repo">
                <li class="repo-download">
                    <a href="//archive/master.zip" target="_blank" title="Download" data-action="download">
                        <i class="icon icon-download"></i> Download
                    </a>
                </li>
                <li class="repo-stars">
                    <a href="//stargazers" target="_blank" title="Stargazers" data-action="star">
                        <i class="icon icon-star"></i> Stars
                        <span class="count">&ndash;</span>
                    </a>
                </li>
            </ul>
            <hr> 

            <div class="toc">
                
                <ul>
                    
<nav role="navigation">
  <ul class="list pa0 nl2">
    
      
      <li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
        <a href="javascript:void(0)" class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2  primary-parent-color" data-target=".Hiboot Cloud Native Application Framework">Hiboot Cloud Native Application Framework</a>
        <ul class="Hiboot Cloud Native Application Framework desktopmenu animated fadeIn list pl0 bg-light-gray db">
          <li class="f6 fw4">
            <a href="https://hiboot.hidevops.io/auto-configure/" class="db link hover-bg-gray hover-white pl3 pr2 pv2 black ">
              Auto Configuration
            </a>
          </li>
          <li class="f6 fw4">
            <a href="https://hiboot.hidevops.io/cli-app/" class="db link hover-bg-gray hover-white pl3 pr2 pv2 black ">
              Cli Applications
            </a>
          </li>
          <li class="f6 fw4">
            <a href="https://hiboot.hidevops.io/web-app/" class="db link hover-bg-gray hover-white pl3 pr2 pv2 primary-color ">
              Web Application
            </a>
          </li>
        </ul>
      </li>
      
      <li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
        <a href="javascript:void(0)" class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2 " data-target=".getting-started">Getting Started</a>
        <ul class="getting-started desktopmenu animated fadeIn list pl0 bg-light-gray dn">
          <li class="f6 fw4">
            <a href="https://hiboot.hidevops.io/getting-started/" class="db link hover-bg-gray hover-white pl3 pr2 pv2 black ">
              Getting started
            </a>
          </li>
        </ul>
      </li>
  </ul>
</nav>

                </ul>
                 
                <hr>
                <span class="section">The author</span>

                <ul>
                    
                    <li>
                        <a href="https://twitter.com/johndcn" target="_blank" title="@johndcn on Twitter">
              @johndcn on Twitter
            </a>
                    </li>
                     
                    <li>
                        <a href="https://github.com/hidevopsio" target="_blank" title="@hidevopsio on GitHub">
              @hidevopsio on GitHub
            </a>
                    </li>
                     
                    <li>
                        <a href="mailto:hi.devops.io@gmail.com" title="Email of hi.devops.io@gmail.com">
              Contact via email
            </a>
                    </li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</nav>
    </div>
    <article class="article">
        <div class="wrapper">
            <div class="contentWrapper">
                <h1>Web Application </h1>
                

<h2 id="features">Features</h2>

<ul>
<li>*Web MVC (Model-View-Controller).</li>
<li>Auto Configuration, pre-created instance with properties configs for dependency injection.</li>
<li>Dependency injection with the struct tag `inject:&ldquo;&rdquo;` or the constructor.
<br /></li>
</ul>

<h2 id="introduction-to-hiboot-mvc">Introduction to Hiboot MVC</h2>

<p>Hiboot prefers to hide the business-independent code, so that the developers will concentrate the business logic.</p>

<p>unlike most of the Go web frameworks, Hiboot does not need to setup routes. Hiboot use reflection to construct the routes.</p>

<h2 id="project-structure">Project structure</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">.
├── config
│   ├── application-gorm.yml
│   ├── application-local.yml
│   ├── application.yml
│   ├── i18n
│   │   ├── en-US.ini
│   │   └── zh-CN.ini
│   ├── keygen.sh
│   └── ssl
│       ├── app.rsa
│       └── app.rsa.pub
├── main.go
├── main_test.go
├── controller
│   ├── user.go
│   └── user_test.go
├── entity
│   ├── user.go
│   └── user_test.go
└── service
    ├── user.go
    └── user_test.go</code></pre></div>
<p>Hiboot application include source code and config</p>

<h2 id="application-properties">Application properties</h2>

<p>Hiboot lets you externalize your configuration so that you can work with the same application code in different environments.</p>

<p>Property values can be injected directly into the struct using the `value:&ldquo;&rdquo;` tag.</p>

<p>To provide a concrete example, suppose you develop a struct that uses a <code>app.name</code> property, as shown in the following example：</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">MyService</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">AppName</span> <span class="kt">string</span> <span class="s">`value:&#34;${app.name}&#34;`</span>
<span class="p">}</span></code></pre></div>
<h2 id="common-application-properties">Common application properties</h2>

<p>Various properties can be specified inside your application.yml file. Hiboot loads properties form application.yml in config folder of working directory.</p>

<h3 id="config-application-yml">config/application.yml</h3>
<div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml">app<span class="p">:</span><span class="w">
</span><span class="w">  </span>project<span class="p">:</span><span class="w"> </span>examples<span class="w">  
</span><span class="w">  </span>name<span class="p">:</span><span class="w"> </span>gorm-demo<span class="w">
</span><span class="w">  </span>profiles<span class="p">:</span><span class="w">
</span><span class="w">    </span>include<span class="p">:</span><span class="w">
</span><span class="w">    </span>-<span class="w"> </span>actuator<span class="w">
</span><span class="w">    </span>-<span class="w"> </span>locale<span class="w">
</span><span class="w">    </span>-<span class="w"> </span>logging<span class="w">
</span><span class="w">    </span>-<span class="w"> </span>gorm<span class="w">
</span><span class="w"></span>logging<span class="p">:</span><span class="w">
</span><span class="w">  </span>level<span class="p">:</span><span class="w"> </span>info</code></pre></div>
<h3 id="application-yml-field-description">application.yml field description</h3>

<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Options</th>
<th>Example</th>
</tr>
</thead>

<tbody>
<tr>
<td>app.project</td>
<td>project name</td>
<td>any string</td>
<td>examples</td>
</tr>

<tr>
<td>app.name</td>
<td>application name</td>
<td>any string</td>
<td>gorm-demo</td>
</tr>

<tr>
<td>app.profiles.active</td>
<td>application active profile</td>
<td>local,dev,test,staging,prod</td>
<td>dev</td>
</tr>

<tr>
<td>app.profiles.include</td>
<td>we use this field as starter switcher，⚠️ if the starter is imported in your source file but it&rsquo;s not included here, the starter will not be initialized</td>
<td>pakcage name of the starter</td>
<td>actuator, locale, logging, gorm</td>
</tr>

<tr>
<td>logging.level</td>
<td>set the logging level</td>
<td>debug,info,warn,error,fatal</td>
<td>info</td>
</tr>
</tbody>
</table>

<h2 id="profile-specific-properties">Profile-specific properties</h2>

<p>In addition to <code>application.yml</code> file, profile-specific properties can also be defined by using the following naming convention: <code>application-${profile}.yml</code>, active profiles can be set in <code>application.yml</code>.</p>

<p>Profile-specific properties are loaded from the same locations as standard <code>application.yml</code>, with profile-specific files always overriding the non-specific ones. <code>application-${app.profiles.active}.yml</code> is always be the highest priority.</p>

<h3 id="config-application-local-yml">config/application-local.yml</h3>
<div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml">server<span class="p">:</span><span class="w">
</span><span class="w">  </span>port<span class="p">:</span><span class="w"> </span><span class="m">8081</span><span class="w">
</span><span class="w"></span>logging<span class="p">:</span><span class="w">
</span><span class="w">  </span>level<span class="p">:</span><span class="w"> </span>debug</code></pre></div>
<h3 id="application-local-yml-field-description">application-local.yml field description</h3>

<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Options</th>
<th>Example</th>
</tr>
</thead>

<tbody>
<tr>
<td>server.port</td>
<td>service port that the application is listening on, it will overwrite the server.port in application.yml</td>
<td>any number</td>
<td>8081</td>
</tr>

<tr>
<td>logging.level</td>
<td>set logging level</td>
<td>debug,info,warn,error,fatal</td>
<td>info</td>
</tr>
</tbody>
</table>

<h3 id="config-application-gorm-yml">config/application-gorm.yml</h3>
<div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml">gorm<span class="p">:</span><span class="w">
</span><span class="w">  </span>type<span class="p">:</span><span class="w"> </span>mysql<span class="w">
</span><span class="w">  </span>host<span class="p">:</span><span class="w"> </span>mysql-${app.profiles.active<span class="p">:</span>dev}<span class="w">
</span><span class="w">  </span>port<span class="p">:</span><span class="w"> </span><span class="m">3306</span><span class="w">
</span><span class="w">  </span>database<span class="p">:</span><span class="w"> </span>${app.name<span class="p">:</span>test}<span class="w">
</span><span class="w">  </span>username<span class="p">:</span><span class="w"> </span>demo<span class="w">
</span><span class="w">  </span>password<span class="p">:</span><span class="w"> </span>fafUJCsVXf2Thj0d4n6UqNdX2PfI08fMyaNlrZhbJVVkghnZ+Zc/WCdITXflJpHZjYH5+LbLviy/6j9etPNwtdyAOXiqKI62itC6nDgp0Xlzu0qX8MwMIIAosUwaYpnflg23hRZnueKrq6SrEpkx4X+LWluDgHb2O5VfGGvHliE=<span class="w">
</span><span class="w">  </span>charset<span class="p">:</span><span class="w"> </span>utf8<span class="w">
</span><span class="w">  </span>parseTime<span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="w">  </span>loc<span class="p">:</span><span class="w"> </span>Asia/Shanghai<span class="w">
</span><span class="w">  </span>config<span class="p">:</span><span class="w">
</span><span class="w">	</span>decrypt<span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="w">	</span></code></pre></div>
<h4 id="application-gorm-yml-field-description">application-gorm.yml field description</h4>

<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Options</th>
<th>Example</th>
</tr>
</thead>

<tbody>
<tr>
<td>gorm.type</td>
<td>database type</td>
<td>mysql,postgres,sqlite3,mssql</td>
<td>mysql</td>
</tr>

<tr>
<td>gorm.host</td>
<td>database host, can be IP address or DNS name, <code>mysql-${app.profiles.active}</code> if environment variable <code>APP_PROFILES_ACTIVE</code>  is set to <code>local</code>，then gorm.host will be <code>mysql-local</code>）</td>
<td><code>mysql-${app.profiles.active}</code></td>
<td></td>
</tr>

<tr>
<td>gorm.port</td>
<td>database port</td>
<td>any port</td>
<td>3306</td>
</tr>

<tr>
<td>gorm.database</td>
<td>database name</td>
<td>string or variable</td>
<td><code>${app.name:test}</code></td>
</tr>

<tr>
<td>gorm.username</td>
<td>username for databse connection</td>
<td>valid username in string</td>
<td>dbuser</td>
</tr>

<tr>
<td>gorm.password</td>
<td>password for database connnection, if gorm.config.decrypt is true，then it will be the password that encrypted by <a href="https://github.com/hidevopsio/crypto">crypto</a></td>
<td>string</td>
<td>fafUJ &hellip; O5VfGGvHliE=</td>
</tr>

<tr>
<td>gorm.charset</td>
<td>character set</td>
<td>utf8,ascii</td>
<td>utf8</td>
</tr>

<tr>
<td>gorm.parseTime</td>
<td>parse time or not</td>
<td>true,false</td>
<td>true</td>
</tr>

<tr>
<td>gorm.loc</td>
<td>timezone</td>
<td>see <a href="https://www.worldtimezone.com/index_cn.php">world timezone</a></td>
<td>Asia/Shanghai</td>
</tr>

<tr>
<td>gorm.config.decrypt</td>
<td>decrypt or not</td>
<td>true,false</td>
<td>true</td>
</tr>
</tbody>
</table>

<h2 id="writing-the-code">Writing the Code</h2>

<p>To write Hiboot application, as we know, the executable commands must always use package main, so we need to create the main package first.</p>

<p>See <a href="https://golang.org/doc/effective_go.html#names">Effective GO</a> to learn more about Go&rsquo;s naming conventions.</p>

<h3 id="main-go">main.go</h3>

<p>There are two parts inside the main package：imports and the entrance of the web application。</p>

<ol>
<li><p>In order to decouple each packages, hiboot use registeration, auto configuration and dependency injection, as  we need to import some packages solely for their side effects, for exampole: <code>_ &quot;hidevops.io/hiboot-data/examples/gorm/controller&quot;</code>, if you used hiboot starter you may need import them in this way as well：<code>_ &quot;hidevops.io/hiboot/pkg/starter/actuator&quot;</code>, <code>_ &quot;hidevops.io/hiboot/pkg/starter/locale&quot;</code>, <code>_ &quot;hidevops.io/hiboot/pkg/starter/logging&quot;</code></p></li>

<li><p>the function main is extremely simple, that is <code>web.NewApplication().Run()</code>, the package <code>web</code> is imported from <code>hidevops.io/hiboot/pkg/app/web</code></p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="nx">_</span> <span class="s">&#34;hidevops.io/hiboot-data/examples/gorm/controller&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot/pkg/app/web&#34;</span>
	<span class="nx">_</span> <span class="s">&#34;hidevops.io/hiboot/pkg/starter/actuator&#34;</span>
	<span class="nx">_</span> <span class="s">&#34;hidevops.io/hiboot/pkg/starter/locale&#34;</span>
	<span class="nx">_</span> <span class="s">&#34;hidevops.io/hiboot/pkg/starter/logging&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">web</span><span class="p">.</span><span class="nf">NewApplication</span><span class="p">().</span><span class="nf">Run</span><span class="p">()</span>
<span class="p">}</span></code></pre></div></li>
</ol>

<blockquote>
<p>Alternatively, you can set property <code>app.ProfilesInclude</code> in main function. In this approach, you don&rsquo;t have to import starter packages solely for their side effects.</p>
</blockquote>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;hidevops.io/hiboot/pkg/app/web&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot/pkg/app&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot/pkg/starter/actuator&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot/pkg/starter/logging&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span>  <span class="p">{</span>
	<span class="nx">web</span><span class="p">.</span><span class="nf">NewApplication</span><span class="p">().</span>
		<span class="nf">SetProperty</span><span class="p">(</span><span class="nx">app</span><span class="p">.</span><span class="nx">ProfilesInclude</span><span class="p">,</span>
			<span class="nx">actuator</span><span class="p">.</span><span class="nx">Profile</span><span class="p">,</span>
			<span class="nx">logging</span><span class="p">.</span><span class="nx">Profile</span><span class="p">).</span>
		<span class="nf">Run</span><span class="p">()</span>
<span class="p">}</span></code></pre></div>
<h3 id="controller-controller-user-go">Controller - controller/user.go</h3>

<p>Now lets see how does the Hiboot controller works, the controller <code>userController</code> is embedded a struct <code>at.RestController</code>, it tells Hiboot that this is a web controller。</p>

<p><code>newUserController</code> is the constructor of struct <code>userController</code>, the dependency <code>userService service.UserService</code> is injecting through the argument of the constructor  during the initialization of <code>newUserController</code>。</p>

<p>For the simplicity purpose, Hiboot does not need to config route, the method name is the route.</p>

<p>Here is the list of the HTTP methods,</p>

<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
<th>Options</th>
<th>Example</th>
</tr>
</thead>

<tbody>
<tr>
<td>Get</td>
<td>GET</td>
<td>Get or GetById which in camel case</td>
<td><code>func (c *userController) GetById(id unit64)</code></td>
</tr>

<tr>
<td>Post</td>
<td>POST</td>
<td>Post PostUser which in camel case</td>
<td><code>func (c *userController) Post(request *userRequest)</code></td>
</tr>

<tr>
<td>Put</td>
<td>PUT</td>
<td>Put or PutUser which in camel case</td>
<td><code>func (c *userController) Post(request *userRequest)</code></td>
</tr>

<tr>
<td>Delete</td>
<td>DELETE</td>
<td>Delete DeleteById which in camel case</td>
<td><code>func (c *userController) DeleteById(id unit64)</code></td>
</tr>
</tbody>
</table>

<p>⚠️  Note that the constructor newUserController of the controller must be registered in the func <code>init()</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">controller</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;hidevops.io/hiboot-data/examples/gorm/entity&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot-data/examples/gorm/service&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot/pkg/app&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot/pkg/app/web&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot/pkg/model&#34;</span>
	<span class="s">&#34;net/http&#34;</span>
<span class="p">)</span>

<span class="c1">// RestController
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">userController</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">at</span><span class="p">.</span><span class="nx">RestController</span>
	<span class="nx">userService</span> <span class="nx">service</span><span class="p">.</span><span class="nx">UserService</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">app</span><span class="p">.</span><span class="nf">Register</span><span class="p">(</span><span class="nx">newUserController</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// newUserController inject userService automatically
</span><span class="c1"></span><span class="kd">func</span> <span class="nf">newUserController</span><span class="p">(</span><span class="nx">userService</span> <span class="nx">service</span><span class="p">.</span><span class="nx">UserService</span><span class="p">)</span> <span class="o">*</span><span class="nx">userController</span> <span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="nx">userController</span><span class="p">{</span>
		<span class="nx">userService</span><span class="p">:</span> <span class="nx">userService</span><span class="p">,</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Post POST /user
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">userController</span><span class="p">)</span> <span class="nf">Post</span><span class="p">(</span><span class="nx">request</span> <span class="o">*</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">)</span> <span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">Response</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">err</span> <span class="o">:=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">userService</span><span class="p">.</span><span class="nf">AddUser</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span>
	<span class="nx">response</span> <span class="o">:=</span> <span class="nb">new</span><span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">BaseResponse</span><span class="p">)</span>
	<span class="nx">response</span><span class="p">.</span><span class="nf">SetData</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span>
	<span class="k">return</span> <span class="nx">response</span><span class="p">,</span> <span class="nx">err</span>
<span class="p">}</span>

<span class="c1">// GetById GET /id/{id}
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">userController</span><span class="p">)</span> <span class="nf">GetById</span><span class="p">(</span><span class="nx">id</span> <span class="kt">uint64</span><span class="p">)</span> <span class="p">(</span><span class="nx">response</span> <span class="nx">model</span><span class="p">.</span><span class="nx">Response</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">user</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">userService</span><span class="p">.</span><span class="nf">GetUser</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
	<span class="nx">response</span> <span class="p">=</span> <span class="nb">new</span><span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">BaseResponse</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
		<span class="nx">response</span><span class="p">.</span><span class="nf">SetCode</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusNotFound</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="nx">response</span><span class="p">.</span><span class="nf">SetData</span><span class="p">(</span><span class="nx">user</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">return</span>
<span class="p">}</span>

<span class="c1">// GetById GET /id/{id}
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">userController</span><span class="p">)</span> <span class="nf">GetAll</span><span class="p">()</span> <span class="p">(</span><span class="nx">response</span> <span class="nx">model</span><span class="p">.</span><span class="nx">Response</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">users</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">userService</span><span class="p">.</span><span class="nf">GetAll</span><span class="p">()</span>
	<span class="nx">response</span> <span class="p">=</span> <span class="nb">new</span><span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">BaseResponse</span><span class="p">)</span>
	<span class="nx">response</span><span class="p">.</span><span class="nf">SetData</span><span class="p">(</span><span class="nx">users</span><span class="p">)</span>
	<span class="k">return</span>
<span class="p">}</span>

<span class="c1">// DeleteById DELETE /id/{id}
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">userController</span><span class="p">)</span> <span class="nf">DeleteById</span><span class="p">(</span><span class="nx">id</span> <span class="kt">uint64</span><span class="p">)</span> <span class="p">(</span><span class="nx">response</span> <span class="nx">model</span><span class="p">.</span><span class="nx">Response</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">err</span> <span class="p">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">userService</span><span class="p">.</span><span class="nf">DeleteUser</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
	<span class="nx">response</span> <span class="p">=</span> <span class="nb">new</span><span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">BaseResponse</span><span class="p">)</span>
	<span class="k">return</span>
<span class="p">}</span></code></pre></div>
<h3 id="entity-user-go">entity/user.go</h3>

<p>User entity is the business model.</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kd">type</span> <span class="nx">User</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">model</span><span class="p">.</span><span class="nx">RequestBody</span>
	<span class="nx">Id</span>       <span class="kt">uint64</span> <span class="s">`json:&#34;id&#34;`</span>
	<span class="nx">Name</span>     <span class="kt">string</span> <span class="s">`json:&#34;name&#34; validate:&#34;required&#34;`</span>
	<span class="nx">Username</span> <span class="kt">string</span> <span class="s">`json:&#34;username&#34; validate:&#34;required&#34;`</span>
	<span class="nx">Password</span> <span class="kt">string</span> <span class="s">`json:&#34;password&#34; validate:&#34;required&#34;`</span>
	<span class="nx">Email</span>    <span class="kt">string</span> <span class="s">`json:&#34;email&#34; validate:&#34;required,email&#34;`</span>
	<span class="nx">Age</span>      <span class="kt">uint</span>   <span class="s">`json:&#34;age&#34; validate:&#34;gte=0,lte=130&#34;`</span>
	<span class="nx">Gender</span>   <span class="kt">uint</span>   <span class="s">`json:&#34;gender&#34; validate:&#34;gte=0,lte=2&#34;`</span>
<span class="p">}</span>

<span class="c1">// Here we specify the table name as user instead of users by default.
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">u</span> <span class="o">*</span><span class="nx">User</span><span class="p">)</span> <span class="nf">TableName</span><span class="p">()</span> <span class="kt">string</span> <span class="p">{</span>
	<span class="k">return</span> <span class="s">&#34;user&#34;</span>
<span class="p">}</span></code></pre></div>
<h3 id="model-service-user-go">Model -  service/user.go</h3>

<p>Service implements the business logic. We declared an interface <code>UserService</code>，which includes method <code>AddUser</code>, <code>GetUser</code>, <code>GetAll</code>, and <code>DeleteUser</code>, userServiceImpl is the implementation of UserService。</p>

<p>By importing <code>hidevops.io/hiboot-data/starter/gorm</code>，the instance of <code>repository gorm.Repository</code> will be injectable, it will be injected to <code>userServiceImpl</code> through the constructor newUserService.</p>

<p>⚠️  Note that the constructor newUserService must be registered in the func <code>init()</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">service</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;errors&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot-data/examples/gorm/entity&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot-data/starter/gorm&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot/pkg/app&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot/pkg/utils/idgen&#34;</span>
<span class="p">)</span>

<span class="kd">type</span> <span class="nx">UserService</span> <span class="kd">interface</span> <span class="p">{</span>
	<span class="nf">AddUser</span><span class="p">(</span><span class="nx">user</span> <span class="o">*</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
	<span class="nf">GetUser</span><span class="p">(</span><span class="nx">id</span> <span class="kt">uint64</span><span class="p">)</span> <span class="p">(</span><span class="nx">user</span> <span class="o">*</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
	<span class="nf">GetAll</span><span class="p">()</span> <span class="p">(</span><span class="nx">user</span> <span class="o">*</span><span class="p">[]</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
	<span class="nf">DeleteUser</span><span class="p">(</span><span class="nx">id</span> <span class="kt">uint64</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">userServiceImpl</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="c1">// add UserService, it means that the instance of UserServiceImpl can be found by UserService
</span><span class="c1"></span>	<span class="nx">UserService</span>
	<span class="nx">repository</span> <span class="nx">gorm</span><span class="p">.</span><span class="nx">Repository</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
	<span class="c1">// register UserServiceImpl
</span><span class="c1"></span>	<span class="nx">app</span><span class="p">.</span><span class="nf">Register</span><span class="p">(</span><span class="nx">newUserService</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// will inject BoltRepository that configured in hidevops.io/hiboot/pkg/starter/data/bolt
</span><span class="c1"></span><span class="kd">func</span> <span class="nf">newUserService</span><span class="p">(</span><span class="nx">repository</span> <span class="nx">gorm</span><span class="p">.</span><span class="nx">Repository</span><span class="p">)</span> <span class="nx">UserService</span> <span class="p">{</span>
	<span class="nx">repository</span><span class="p">.</span><span class="nf">AutoMigrate</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">{})</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="nx">userServiceImpl</span><span class="p">{</span>
		<span class="nx">repository</span><span class="p">:</span> <span class="nx">repository</span><span class="p">,</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">userServiceImpl</span><span class="p">)</span> <span class="nf">AddUser</span><span class="p">(</span><span class="nx">user</span> <span class="o">*</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="nx">user</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nx">errors</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;user is not allowed nil&#34;</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="nx">user</span><span class="p">.</span><span class="nx">Id</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
		<span class="nx">user</span><span class="p">.</span><span class="nx">Id</span><span class="p">,</span> <span class="nx">_</span> <span class="p">=</span> <span class="nx">idgen</span><span class="p">.</span><span class="nf">Next</span><span class="p">()</span>
	<span class="p">}</span>
	<span class="nx">err</span> <span class="p">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nf">Create</span><span class="p">(</span><span class="nx">user</span><span class="p">).</span><span class="nf">Error</span><span class="p">()</span>
	<span class="k">return</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">userServiceImpl</span><span class="p">)</span> <span class="nf">GetUser</span><span class="p">(</span><span class="nx">id</span> <span class="kt">uint64</span><span class="p">)</span> <span class="p">(</span><span class="nx">user</span> <span class="o">*</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">user</span> <span class="p">=</span> <span class="o">&amp;</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">{}</span>
	<span class="nx">err</span> <span class="p">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="s">&#34;id = ?&#34;</span><span class="p">,</span> <span class="nx">id</span><span class="p">).</span><span class="nf">First</span><span class="p">(</span><span class="nx">user</span><span class="p">).</span><span class="nf">Error</span><span class="p">()</span>
	<span class="k">return</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">userServiceImpl</span><span class="p">)</span> <span class="nf">GetAll</span><span class="p">()</span> <span class="p">(</span><span class="nx">users</span> <span class="o">*</span><span class="p">[]</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">users</span> <span class="p">=</span> <span class="o">&amp;</span><span class="p">[]</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">{}</span>
	<span class="nx">err</span> <span class="p">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="nx">users</span><span class="p">).</span><span class="nf">Error</span><span class="p">()</span>
	<span class="k">return</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">s</span> <span class="o">*</span><span class="nx">userServiceImpl</span><span class="p">)</span> <span class="nf">DeleteUser</span><span class="p">(</span><span class="nx">id</span> <span class="kt">uint64</span><span class="p">)</span> <span class="p">(</span><span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">err</span> <span class="p">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">repository</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="s">&#34;id = ?&#34;</span><span class="p">,</span> <span class="nx">id</span><span class="p">).</span><span class="nf">Delete</span><span class="p">(</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">{}).</span><span class="nf">Error</span><span class="p">()</span>
	<span class="k">return</span>
<span class="p">}</span></code></pre></div>
<h3 id="run-the-sample-code">Run the sample code</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">go run main.go</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">______  ____________             _____
___  / / /__<span class="o">(</span>_<span class="o">)</span>__  /_______________  /_
__  /_/ /__  /__  __ <span class="se">\ </span> __ <span class="se">\ </span> __ <span class="se">\ </span> __/
_  __  / _  / _  /_/ / /_/ / /_/ / /_     Hiboot Application Framework
/_/ /_/  /_/  /_.___/<span class="se">\_</span>___/<span class="se">\_</span>___/<span class="se">\_</span>_/     https://hidevops.io/hiboot
<span class="o">[</span>INFO<span class="o">]</span> <span class="m">2018</span>/10/23 <span class="m">23</span>:37 Starting Hiboot web application gorm-demo on localhost with PID <span class="m">28423</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="m">2018</span>/10/23 <span class="m">23</span>:37 Working directory: /Users/johnd/.gvm/pkgsets/go1.10/hidevops/src/hidevops.io/hiboot-data/examples/gorm
<span class="o">[</span>INFO<span class="o">]</span> <span class="m">2018</span>/10/23 <span class="m">23</span>:37 The following profiles are active: local, <span class="o">[</span>actuator locale logging gorm<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="m">2018</span>/10/23 <span class="m">23</span>:37 Auto configure gorm starter
<span class="o">[</span>INFO<span class="o">]</span> <span class="m">2018</span>/10/23 <span class="m">23</span>:37 Auto configure locale starter
<span class="o">[</span>INFO<span class="o">]</span> <span class="m">2018</span>/10/23 <span class="m">23</span>:37 Auto configure logging starter
<span class="o">[</span>INFO<span class="o">]</span> <span class="m">2018</span>/10/23 <span class="m">23</span>:37 The dependency graph resolved successfully
<span class="o">[</span>INFO<span class="o">]</span> <span class="m">2018</span>/10/23 <span class="m">23</span>:37 connected to dataSource demo@mysql-local:3306/gorm_demo
<span class="o">[</span>DBUG<span class="o">]</span> <span class="m">2018</span>/10/23 <span class="m">23</span>:36 GET: /health -&gt; github.com/hidevops	io/hiboot-data/vendor/hidevops.io/hiboot/pkg/starter/actuator/controller/healthController.Get<span class="o">()</span> and <span class="m">2</span> more
<span class="o">[</span>DBUG<span class="o">]</span> <span class="m">2018</span>/10/23 <span class="m">23</span>:36 DELETE: /user/id/<span class="o">{</span>id<span class="o">}</span> -&gt; hidevops.io/hiboot-data/examples/gorm/controller/userController.DeleteById<span class="o">()</span> and <span class="m">2</span> more
<span class="o">[</span>DBUG<span class="o">]</span> <span class="m">2018</span>/10/23 <span class="m">23</span>:36 GET: /user/id/<span class="o">{</span>id<span class="o">}</span> -&gt; hidevops.io/hiboot-data/examples/gorm/controller/userController.GetById<span class="o">()</span> and <span class="m">2</span> more
<span class="o">[</span>DBUG<span class="o">]</span> <span class="m">2018</span>/10/23 <span class="m">23</span>:36 GET: /user/all -&gt; hidevops.io/hiboot-data/examples/gorm/controller/userController.GetAll<span class="o">()</span> and <span class="m">2</span> more
<span class="o">[</span>DBUG<span class="o">]</span> <span class="m">2018</span>/10/23 <span class="m">23</span>:36 POST: /user -&gt; hidevops.io/hiboot-data/examples/gorm/controller/userController.Post<span class="o">()</span> and <span class="m">2</span> more
Now listening on: http://localhost:8080
Application started. Press CMD+C to shut down.</code></pre></div>
<h3 id="make-a-request">Make a request</h3>

<p>Let&rsquo;s make a request on the RESTful API GET /user/all</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">http GET localhost:8080/user/all</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">HTTP/1.1 <span class="m">200</span> OK
Content-Length: <span class="m">307</span>
Content-Type: application/json<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8
Date: Tue, <span class="m">23</span> Oct <span class="m">2018</span> <span class="m">15</span>:38:41 GMT
Set-Cookie: app.language<span class="o">=</span><span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span> <span class="nv">Expires</span><span class="o">=</span>Tue, <span class="m">23</span> Oct <span class="m">2018</span> <span class="m">17</span>:38:41 GMT<span class="p">;</span> Max-Age<span class="o">=</span><span class="m">7200</span><span class="p">;</span> HttpOnly
<span class="o">{</span>
    <span class="s2">&#34;code&#34;</span>: <span class="m">200</span>,
    <span class="s2">&#34;data&#34;</span>: <span class="o">[</span>
        <span class="o">{</span>
            <span class="s2">&#34;age&#34;</span>: <span class="m">18</span>,
            <span class="s2">&#34;email&#34;</span>: <span class="s2">&#34;john.doe@gmail.com&#34;</span>,
            <span class="s2">&#34;gender&#34;</span>: <span class="m">0</span>,
            <span class="s2">&#34;id&#34;</span>: <span class="m">209536579658580081</span>,
            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;John Doe&#34;</span>,
            <span class="s2">&#34;password&#34;</span>: <span class="s2">&#34;poi321&#34;</span>,
            <span class="s2">&#34;username&#34;</span>: <span class="s2">&#34;johnd&#34;</span>
        <span class="o">}</span>,
        <span class="o">{</span>
            <span class="s2">&#34;age&#34;</span>: <span class="m">25</span>,
            <span class="s2">&#34;email&#34;</span>: <span class="s2">&#34;mike.phil@gmail.com&#34;</span>,
            <span class="s2">&#34;gender&#34;</span>: <span class="m">0</span>,
            <span class="s2">&#34;id&#34;</span>: <span class="m">209536656246571121</span>,
            <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;Mike Phil&#34;</span>,
            <span class="s2">&#34;password&#34;</span>: <span class="s2">&#34;iutg039&#34;</span>,
            <span class="s2">&#34;username&#34;</span>: <span class="s2">&#34;mikep&#34;</span>
        <span class="o">}</span>
    <span class="o">]</span>,
    <span class="s2">&#34;message&#34;</span>: <span class="s2">&#34;Success&#34;</span>
<span class="o">}</span></code></pre></div>
<h2 id="unit-test">Unit test</h2>

<p>As I always say, Hiboot is built for production ready, we care about the quality so much, here is the realtime code coverage <a href="https://codecov.io/gh/hidevopsio/hiboot"><img src="https://codecov.io/gh/hidevopsio/hiboot/branch/master/graph/badge.svg" alt="codecov" /></a>. So how do we do the unit testing?</p>

<p>First, let&rsquo;s see the unit test for main.go</p>

<h3 id="mian-test-go">mian_test.go</h3>

<p>As shown below, the unit test for func main，we have <code>go main()</code> inside the test case <code>TestRunMain</code> just for the sake of main func testing。</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;testing&#34;</span>
	<span class="s">&#34;time&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">TestRunMain</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">go</span> <span class="nf">main</span><span class="p">()</span>
	<span class="nx">time</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="mi">200</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Millisecond</span><span class="p">)</span>
<span class="p">}</span></code></pre></div>
<h3 id="mock-up-the-testing-controller-user-test-go">Mock up the testing - controller/user_test.go</h3>

<p>We want to test the <code>userController</code>, but the userController depends on <code>userSerivce</code> which will connect to the real database through gorm repository. In order to do so, we must mock the <code>userService</code>.</p>

<p>We use <a href="https://github.com/vektra/mockery">Mockery</a> to generate the some of the test code, <a href="https://github.com/vektra/mockery">Mockery</a> is a tool that automatically generates mock implementations of interfaces <code>UserService</code>.</p>

<p>First, install mockery,</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">go get github.com/vektra/mockery/.../</code></pre></div>
<p>Then, generate mocks for the interface</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># go to the directory where the UserService is.</span>
<span class="nb">cd</span> <span class="nv">$GOPATH</span>/src/hidevops.io/hiboot-data/examples/gorm/service

<span class="c1"># generate mocks for the interface UserService</span>
mockery -name UserService</code></pre></div>
<p>After that, you will see mocks/UserService is generated under $GOPATH/src/hidevops.io/hiboot-data/examples/gorm/service.</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// Code generated by mockery v1.0.0. DO NOT EDIT.
</span><span class="c1"></span>
<span class="kn">package</span> <span class="nx">mocks</span>

<span class="kn">import</span> <span class="nx">entity</span> <span class="s">&#34;hidevops.io/hiboot-data/examples/gorm/entity&#34;</span>
<span class="kn">import</span> <span class="nx">mock</span> <span class="s">&#34;github.com/stretchr/testify/mock&#34;</span>

<span class="c1">// UserService is an autogenerated mock type for the UserService type
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">UserService</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">mock</span><span class="p">.</span><span class="nx">Mock</span>
<span class="p">}</span>

<span class="c1">// AddUser provides a mock function with given fields: user
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">_m</span> <span class="o">*</span><span class="nx">UserService</span><span class="p">)</span> <span class="nf">AddUser</span><span class="p">(</span><span class="nx">user</span> <span class="o">*</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
	<span class="nx">ret</span> <span class="o">:=</span> <span class="nx">_m</span><span class="p">.</span><span class="nf">Called</span><span class="p">(</span><span class="nx">user</span><span class="p">)</span>

	<span class="kd">var</span> <span class="nx">r0</span> <span class="kt">error</span>
	<span class="k">if</span> <span class="nx">rf</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">).(</span><span class="kd">func</span><span class="p">(</span><span class="o">*</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">)</span> <span class="kt">error</span><span class="p">);</span> <span class="nx">ok</span> <span class="p">{</span>
		<span class="nx">r0</span> <span class="p">=</span> <span class="nf">rf</span><span class="p">(</span><span class="nx">user</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="nx">r0</span> <span class="p">=</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="nx">r0</span>
<span class="p">}</span>

<span class="c1">// DeleteUser provides a mock function with given fields: id
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">_m</span> <span class="o">*</span><span class="nx">UserService</span><span class="p">)</span> <span class="nf">DeleteUser</span><span class="p">(</span><span class="nx">id</span> <span class="kt">uint64</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
	<span class="nx">ret</span> <span class="o">:=</span> <span class="nx">_m</span><span class="p">.</span><span class="nf">Called</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>

	<span class="kd">var</span> <span class="nx">r0</span> <span class="kt">error</span>
	<span class="k">if</span> <span class="nx">rf</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">).(</span><span class="kd">func</span><span class="p">(</span><span class="kt">uint64</span><span class="p">)</span> <span class="kt">error</span><span class="p">);</span> <span class="nx">ok</span> <span class="p">{</span>
		<span class="nx">r0</span> <span class="p">=</span> <span class="nf">rf</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="nx">r0</span> <span class="p">=</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="nx">r0</span>
<span class="p">}</span>

<span class="c1">// GetAll provides a mock function with given fields:
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">_m</span> <span class="o">*</span><span class="nx">UserService</span><span class="p">)</span> <span class="nf">GetAll</span><span class="p">()</span> <span class="p">(</span><span class="o">*</span><span class="p">[]</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">ret</span> <span class="o">:=</span> <span class="nx">_m</span><span class="p">.</span><span class="nf">Called</span><span class="p">()</span>

	<span class="kd">var</span> <span class="nx">r0</span> <span class="o">*</span><span class="p">[]</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span>
	<span class="k">if</span> <span class="nx">rf</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">).(</span><span class="kd">func</span><span class="p">()</span> <span class="o">*</span><span class="p">[]</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">);</span> <span class="nx">ok</span> <span class="p">{</span>
		<span class="nx">r0</span> <span class="p">=</span> <span class="nf">rf</span><span class="p">()</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
			<span class="nx">r0</span> <span class="p">=</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">).(</span><span class="o">*</span><span class="p">[]</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">)</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="kd">var</span> <span class="nx">r1</span> <span class="kt">error</span>
	<span class="k">if</span> <span class="nx">rf</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="mi">1</span><span class="p">).(</span><span class="kd">func</span><span class="p">()</span> <span class="kt">error</span><span class="p">);</span> <span class="nx">ok</span> <span class="p">{</span>
		<span class="nx">r1</span> <span class="p">=</span> <span class="nf">rf</span><span class="p">()</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="nx">r1</span> <span class="p">=</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="nx">r0</span><span class="p">,</span> <span class="nx">r1</span>
<span class="p">}</span>

<span class="c1">// GetUser provides a mock function with given fields: id
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">_m</span> <span class="o">*</span><span class="nx">UserService</span><span class="p">)</span> <span class="nf">GetUser</span><span class="p">(</span><span class="nx">id</span> <span class="kt">uint64</span><span class="p">)</span> <span class="p">(</span><span class="o">*</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">ret</span> <span class="o">:=</span> <span class="nx">_m</span><span class="p">.</span><span class="nf">Called</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>

	<span class="kd">var</span> <span class="nx">r0</span> <span class="o">*</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span>
	<span class="k">if</span> <span class="nx">rf</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">).(</span><span class="kd">func</span><span class="p">(</span><span class="kt">uint64</span><span class="p">)</span> <span class="o">*</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">);</span> <span class="nx">ok</span> <span class="p">{</span>
		<span class="nx">r0</span> <span class="p">=</span> <span class="nf">rf</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
			<span class="nx">r0</span> <span class="p">=</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">).(</span><span class="o">*</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">)</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="kd">var</span> <span class="nx">r1</span> <span class="kt">error</span>
	<span class="k">if</span> <span class="nx">rf</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="mi">1</span><span class="p">).(</span><span class="kd">func</span><span class="p">(</span><span class="kt">uint64</span><span class="p">)</span> <span class="kt">error</span><span class="p">);</span> <span class="nx">ok</span> <span class="p">{</span>
		<span class="nx">r1</span> <span class="p">=</span> <span class="nf">rf</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="nx">r1</span> <span class="p">=</span> <span class="nx">ret</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="nx">r0</span><span class="p">,</span> <span class="nx">r1</span>
<span class="p">}</span></code></pre></div>
<h3 id="writing-the-unit-test-cases">Writing the unit test cases</h3>

<p>Below are the unit test cases, we tested POST, GET, DELETE method to user controller with the mock interface mocks.UserService.</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">controller</span>

<span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;hidevops.io/hiboot-data/examples/gorm/entity&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot/pkg/app/web&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot/pkg/log&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot/pkg/utils/idgen&#34;</span>
	<span class="s">&#34;github.com/stretchr/testify/assert&#34;</span>
	<span class="s">&#34;net/http&#34;</span>
	<span class="s">&#34;testing&#34;</span>
	<span class="s">&#34;hidevops.io/hiboot-data/examples/gorm/service/mocks&#34;</span>
	<span class="s">&#34;errors&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">log</span><span class="p">.</span><span class="nf">SetLevel</span><span class="p">(</span><span class="nx">log</span><span class="p">.</span><span class="nx">DebugLevel</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">TestCrdRequest</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>

	<span class="nx">mockUserService</span> <span class="o">:=</span> <span class="nb">new</span><span class="p">(</span><span class="nx">mocks</span><span class="p">.</span><span class="nx">UserService</span><span class="p">)</span>
	<span class="nx">userController</span> <span class="o">:=</span> <span class="nf">newUserController</span><span class="p">(</span><span class="nx">mockUserService</span><span class="p">)</span>
	<span class="nx">testApp</span> <span class="o">:=</span> <span class="nx">web</span><span class="p">.</span><span class="nf">RunTestApplication</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span> <span class="nx">userController</span><span class="p">)</span>

	<span class="nx">id</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">idgen</span><span class="p">.</span><span class="nf">Next</span><span class="p">()</span>
	<span class="nx">assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>

	<span class="nx">testUser</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">{</span>
		<span class="nx">Id</span><span class="p">:</span>       <span class="nx">id</span><span class="p">,</span>
		<span class="nx">Name</span><span class="p">:</span>     <span class="s">&#34;Bill Gates&#34;</span><span class="p">,</span>
		<span class="nx">Username</span><span class="p">:</span> <span class="s">&#34;billg&#34;</span><span class="p">,</span>
		<span class="nx">Password</span><span class="p">:</span> <span class="s">&#34;3948tdaD&#34;</span><span class="p">,</span>
		<span class="nx">Email</span><span class="p">:</span>    <span class="s">&#34;bill.gates@microsoft.com&#34;</span><span class="p">,</span>
		<span class="nx">Age</span><span class="p">:</span>      <span class="mi">60</span><span class="p">,</span>
		<span class="nx">Gender</span><span class="p">:</span>   <span class="mi">1</span><span class="p">,</span>
	<span class="p">}</span>

	<span class="c1">// first, call mocks.UserService.AddUser
</span><span class="c1"></span>	<span class="nx">mockUserService</span><span class="p">.</span><span class="nf">On</span><span class="p">(</span><span class="s">&#34;AddUser&#34;</span><span class="p">,</span> <span class="nx">testUser</span><span class="p">).</span><span class="nf">Return</span><span class="p">(</span><span class="kc">nil</span><span class="p">)</span>
	<span class="c1">// then run the test that will call UserService.AddUser
</span><span class="c1"></span>	<span class="nx">t</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="s">&#34;should add user with POST request&#34;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// First, let&#39;s Post User
</span><span class="c1"></span>		<span class="nx">testApp</span><span class="p">.</span><span class="nf">Post</span><span class="p">(</span><span class="s">&#34;/user&#34;</span><span class="p">).</span>
			<span class="nf">WithJSON</span><span class="p">(</span><span class="nx">testUser</span><span class="p">).</span>
			<span class="nf">Expect</span><span class="p">().</span><span class="nf">Status</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">)</span>
	<span class="p">})</span>

	<span class="nx">mockUserService</span><span class="p">.</span><span class="nf">On</span><span class="p">(</span><span class="s">&#34;GetUser&#34;</span><span class="p">,</span> <span class="nx">id</span><span class="p">).</span><span class="nf">Return</span><span class="p">(</span><span class="nx">testUser</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>
	<span class="nx">t</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="s">&#34;should get user with GET request&#34;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// Then Get User
</span><span class="c1"></span>		<span class="c1">// e.g. GET /user/id/123456
</span><span class="c1"></span>		<span class="nx">testApp</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;/user/id/{id}&#34;</span><span class="p">).</span>
			<span class="nf">WithPath</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">,</span> <span class="nx">id</span><span class="p">).</span>
			<span class="nf">Expect</span><span class="p">().</span><span class="nf">Status</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">)</span>
	<span class="p">})</span>

	<span class="nx">mockUserService</span><span class="p">.</span><span class="nf">On</span><span class="p">(</span><span class="s">&#34;GetAll&#34;</span><span class="p">).</span><span class="nf">Return</span><span class="p">(</span><span class="o">&amp;</span><span class="p">[]</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">{</span><span class="o">*</span><span class="nx">testUser</span><span class="p">},</span> <span class="kc">nil</span><span class="p">)</span>
	<span class="nx">t</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="s">&#34;should get user with GET request&#34;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// Then Get User
</span><span class="c1"></span>		<span class="c1">// e.g. GET /user/id/123456
</span><span class="c1"></span>		<span class="nx">testApp</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;/user/all&#34;</span><span class="p">).</span>
			<span class="nf">Expect</span><span class="p">().</span><span class="nf">Status</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">)</span>
	<span class="p">})</span>

	<span class="c1">// assert that the expectations were met
</span><span class="c1"></span>	<span class="nx">mockUserService</span><span class="p">.</span><span class="nf">AssertExpectations</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span>

	<span class="nx">unknownId</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">idgen</span><span class="p">.</span><span class="nf">Next</span><span class="p">()</span>
	<span class="nx">assert</span><span class="p">.</span><span class="nf">Equal</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
	<span class="nx">mockUserService</span><span class="p">.</span><span class="nf">On</span><span class="p">(</span><span class="s">&#34;GetUser&#34;</span><span class="p">,</span> <span class="nx">unknownId</span><span class="p">).</span><span class="nf">Return</span><span class="p">((</span><span class="o">*</span><span class="nx">entity</span><span class="p">.</span><span class="nx">User</span><span class="p">)(</span><span class="kc">nil</span><span class="p">),</span> <span class="nx">errors</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="s">&#34;not found&#34;</span><span class="p">))</span>

	<span class="nx">t</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="s">&#34;should return 404 if trying to find a record that does not exist&#34;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// Then Get User
</span><span class="c1"></span>		<span class="nx">testApp</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;/user/id/{id}&#34;</span><span class="p">).</span>
			<span class="nf">WithPath</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">,</span> <span class="nx">unknownId</span><span class="p">).</span>
			<span class="nf">Expect</span><span class="p">().</span><span class="nf">Status</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusNotFound</span><span class="p">)</span>
	<span class="p">})</span>

	<span class="c1">// assert that the expectations were met
</span><span class="c1"></span>	<span class="nx">mockUserService</span><span class="p">.</span><span class="nf">AssertExpectations</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span>

	<span class="nx">mockUserService</span><span class="p">.</span><span class="nf">On</span><span class="p">(</span><span class="s">&#34;DeleteUser&#34;</span><span class="p">,</span> <span class="nx">id</span><span class="p">).</span><span class="nf">Return</span><span class="p">(</span><span class="kc">nil</span><span class="p">)</span>
	<span class="nx">t</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="s">&#34;should delete the record with DELETE request&#34;</span><span class="p">,</span> <span class="kd">func</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">testing</span><span class="p">.</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// Finally Delete User
</span><span class="c1"></span>		<span class="nx">testApp</span><span class="p">.</span><span class="nf">Delete</span><span class="p">(</span><span class="s">&#34;/user/id/{id}&#34;</span><span class="p">).</span>
			<span class="nf">WithPath</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">,</span> <span class="nx">id</span><span class="p">).</span>
			<span class="nf">Expect</span><span class="p">().</span><span class="nf">Status</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">)</span>
	<span class="p">})</span>
<span class="p">}</span></code></pre></div>
<h3 id="finally-let-run-above-unit-tests-the-test-result-is-positive">Finally, Let run above unit tests, the test result is positive.</h3>

<p><img src="https://hiboot.hidevops.io/images/web-app/unit-test.png" alt="unit-test" /></p>

                <div class="order-0 w-20 dn db-l">
                    
<nav role="navigation">
  <ul class="list pa0 nl2">
    
      
      <li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
        <a href="javascript:void(0)" class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2  primary-color" data-target=".Hiboot Cloud Native Application Framework">Hiboot Cloud Native Application Framework</a>
        <ul class="Hiboot Cloud Native Application Framework desktopmenu animated fadeIn list pl0 bg-light-gray db">
          <li class="f6 fw4">
            <a href="https://hiboot.hidevops.io/auto-configure/" class="db link hover-bg-gray hover-white pl3 pr2 pv2 black ">
              Auto Configuration
            </a>
          </li>
          <li class="f6 fw4">
            <a href="https://hiboot.hidevops.io/cli-app/" class="db link hover-bg-gray hover-white pl3 pr2 pv2 black ">
              Cli Applications
            </a>
          </li>
          <li class="f6 fw4">
            <a href="https://hiboot.hidevops.io/web-app/" class="db link hover-bg-gray hover-white pl3 pr2 pv2 primary-color ">
              Web Application
            </a>
          </li>
        </ul>
      </li>
      
      <li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
        <a href="javascript:void(0)" class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2 " data-target=".getting-started">Getting Started</a>
        <ul class="getting-started desktopmenu animated fadeIn list pl0 bg-light-gray dn">
          <li class="f6 fw4">
            <a href="https://hiboot.hidevops.io/getting-started/" class="db link hover-bg-gray hover-white pl3 pr2 pv2 black ">
              Getting started
            </a>
          </li>
        </ul>
      </li>
  </ul>
</nav>

                </div>
                <aside class="copyright" role="note">
                     &copy; 2019 Released under the Apache 2.0 license &ndash;  - By John Deng.
                </aside>
            </div>

            <footer class="footer">
                

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://hiboot.hidevops.io/cli-app/" title="Cli Applications">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Cli Applications
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://hiboot.hidevops.io/getting-started/" title="Getting started">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Getting started
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





            </footer>
        </div>
    </article>
    <div class="sticky">
	
	
	
	
		
		
		
	
		
		<div class="col-md-2 pl-0">
			
			<div id="page-scrollspy" class="toc-nav">
				
				<ul class="nav nav-pills ml-0">
					
					<li class="nav-item pb-3 text-center">
						<span class="font-weight-bold mb-2">- What's on this Page - </span>
					</li>
					
						
						
							
								
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#features">
												 Features
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#introduction-to-hiboot-mvc">
												 Introduction to Hiboot MVC
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#project-structure">
												 Project structure
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#application-properties">
												 Application properties
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#common-application-properties">
												 Common application properties
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#config-application-yml">
												 config/application.yml
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#application-yml-field-description">
												 application.yml field description
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#profile-specific-properties">
												 Profile-specific properties
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#config-application-local-yml">
												 config/application-local.yml
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#application-local-yml-field-description">
												 application-local.yml field description
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#config-application-gorm-yml">
												 config/application-gorm.yml
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#application-gorm-yml-field-description">
												 application-gorm.yml field description
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#writing-the-code">
												 Writing the Code
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#main-go">
												 main.go
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#controller-controller-user-go">
												 Controller - controller/user.go
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#entity-user-go">
												 entity/user.go
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#model-service-user-go">
												 Model - service/user.go
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#run-the-sample-code">
												 Run the sample code
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#make-a-request">
												 Make a request
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#unit-test">
												 Unit test
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#mian-test-go">
												 mian_test.go
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#mock-up-the-testing-controller-user-test-go">
												 Mock up the testing - controller/user_test.go
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#writing-the-unit-test-cases">
												 Writing the unit test cases
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								
										<li class="nav-item">
						 					<a class="nav-link" href="#finally-let-run-above-unit-tests-the-test-result-is-positive">
												 Finally, Let run above unit tests, the test result is positive.
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
				</ul>
			</div>
			
		</div>
		
	</div>
    <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
            <div class="wrapper">
                <div class="meta"></div>
                <div class="list"></div>
            </div>
        </div>
    </div>
</main>

    <script>
    
      var base_url = 'https:\/\/hiboot.hidevops.io\/';
      var repo_id  = '\/';
    
    </script>

    <script src="https://hiboot.hidevops.io/javascripts/application.js"></script>
    <script src="https://hiboot.hidevops.io/javascripts/menutoggle.js"></script>
    <script src="https://hiboot.hidevops.io/javascripts/bootstrap.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = " ";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
